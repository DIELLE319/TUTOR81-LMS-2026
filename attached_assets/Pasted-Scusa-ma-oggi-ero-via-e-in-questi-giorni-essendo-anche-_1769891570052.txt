Scusa ma oggi ero via e in questi giorni, essendo anche fine mese, ho scadenze importanti.
Non posso spiegarvi tutto il codice e tutto il database. Dovete leggere il codice, file per file, e leggere il database, tabella per tabella, colonna per colonna. Ma sul serio, perché non ci credo che non abbiate trovato nel file lib/class_company.php qual'è la funzione che crea un'azienda. Non ci credo. Chissà come si chiamerà, forse createCompany? Se non lo vuoi leggere tu, l'AI che stai usando deve per forza averla trovata. Lo so perché ho provato a far commentare a un IA la funzione e senza spiegargli nulla ha capito esattamente a cosa serve e cosa sono i parametri che gli vanno passati.

Il collegamento fra learning project e corsi (e a dire il vero si sarebbe potuto collegare direttamente al learning project in questa tabella anche lezioni e moduli, era questa l'idea iniziale) lo trovi nella tabella "unities". Apritela e leggete il nome delle colonne e capirete.

Il collegamento tra ente formativo e azienda, te l'ho spiegato tante volte, è basato sull'utente dell'ente formativo che la crea. Apri la tabella "companies" e cerca la colonna "owner_user_id". Questo è l'utente 'propietario' ed è un utente dell'ente formativo. Insomma l'azienda è dell'ente formativo di cui fa parte l'utente "owner_user_id".

Chi sono gli amministratori degli enti formativi? Beh, questa è proprio elementare. Tutti gli utenti sono nella tabella "users". Un utente con ruolo "amministratore di un ente formativo" (role_id = 1) è l'amministratore dell'ente formativo a cui appartiene (company_id). Si, "company_id", perchè anche gli enti formativi sono delle aziende quindi sono nella tabella companies. Come si distingue un ente formativo da un'azienda non ente formativo? Colonna is_tutor della tabella companies: 1 se è ente formativo (valore booleano per VERO, quindi is_tutor? 1=VERO). 0, non è un ente formativo (valore booleando per FALSO, quindi is_tutor? 0=FALSO).

Te l'ho detto, il database e il codice è grande e complicato. Già all'inizio, quando sono arrivato io era complicato. Poi con il tempo e le mille modifiche fatte di fretta, perchè uno voleva una cosa, un'altro ne voleva un'altra, tu arrivavi con un'idea e dopo un po' la cambiavi, insomma si è complicato moltissimo. Io avevo già pensato di aggiornarlo con l'IA, ma ho visto che era troppo complicato. Magari si possono aggiungere delle funzionalità, come un sito di e-commerce o l'integrazione per i corsi in video conferenza, aggiornare il codice PHP, BOOTSTRAP e i Plugin. Ma rifare tutto mantenendo il Database senza conoscere a fondo l'architettura, i concetti e tutti i ragionamenti fatti in questi anni, che spesso faccio fatico io stesso a ricordare e capire, è un'impresa. Tanto che io avevo pensato di rifarla completamente usando l'AI, rifacendo anche il database ... ma anche lì ci vuole tempo.