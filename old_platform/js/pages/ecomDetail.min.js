$(document).ready(function(){var p;var w=$("#checkout-pagamento");var J=0.22;var a;var i;var y=$("#checkoutEmailSpedizione");var l=$("#checkoutEmailLabel");var f=$(".checkoutId");var G=$(".checkoutTitle");var B=$(".checkoutTipo");var g=$(".checkoutOre");var j=$(".checkoutImage");var D=$(".checkoutQuantita");var b=$(".checkoutPrezzo");var I=$(".checkoutVatPrezzo");var z=$(".checkoutSubTotale");var e=$(".checkoutTotSubTotale");var r=$("input:radio[name=checkout-payments]");var A=$(".checkoutTotale");var s=$("#tutorCompanyID");var u=$("#tutorAdminID");var m=function(){$("#paypal").hide();$("#bonifico").show();r[0].checked=true};var h=function(){$("#bonifico").hide();$("#paypal").show();r[1].checked=true};var d=function(){return z.val().replace(",",".")*J};var x=function(){return b.val().replace(",",".")*D.val()};var o=function(){return d()+x()};var H=function(){z.each(function(){var K=parseFloat(x()).toFixed(2);$(this).val(String(K).replace(".",","))});e.each(function(){var K=parseFloat(x()).toFixed(2);$(this).val(String(K).replace(".",","))});I.each(function(){var K=parseFloat(d()).toFixed(2);$(this).val(String(K).replace(".",","))});A.each(function(){var K=parseFloat(o()).toFixed(2);$(this).val(String(K).replace(".",","))})};var C=function(K){D.each(function(){$(this).val(K)})};var v=function(K){b.each(function(){$(this).val(String(K).replace(".",","))})};var q=function(){var K=parseInt(D.val());i.each(function(){var O=$(this);var M=O.find(".amountRange").html().trim().split("-");var N=parseInt(M[0]);var L=parseInt(M[1]);if(K>=N&&K<=L){console.log(M);var P=O.find(".amountPrice").html().substring(2).trim();console.log(P);v(P)}})};var n=$("#checkout-wizard");n.formwizard({disableUIStyles:true,inDuration:0,outDuration:0,textBack:"Indietro",textNext:"Prossimo",textSubmit:"Acquista"});var t=function(K){if(K=="checkout-first"){console.log(K)}else{if(K=="checkout-second"){console.log(K)}else{if(K=="checkout-third"){console.log(K)}else{if(K=="checkout-fourth"){console.log(K);l.html(y.val())}else{console.log("No tabIndex")}}}}};$("#checkout-payment-bonifico").click(function(){m()});$("#checkout-payment-paypal").click(function(){h()});$("#back").on("click",function(){n.formwizard("show","checkout-first")});n.bind("before_step_shown",function(K,L){t(L.currentStep)});$(D.get(0)).on("change",function(){C($(this).val());q();H()});var E=$("#dec");E.prop("disabled",true);E.click(function(){var K=parseInt($(D.get(0)).val())-1;if(K==1){E.prop("disabled",true)}C(K);q();H()});var k=$("#inc");k.click(function(){var K=parseInt($(D.get(0)).val())+1;C(K);E.prop("disabled",false);q();H()});$(document).on("click",".buttonAcquista",function(){p=$(this).closest(".store-item");var M=p;console.log(M);var N=$(".productId").text();console.log(N);var Q=$(".productTitle").text();console.log(Q);var L=$(".productTipo").text();console.log(L);var K=$(".productOre").text();console.log(K);var P=$(".productImageSrc").attr("src");console.log(P);var O=$(".productPrice").text();console.log(O);i=M.find(".productPriceListRow");console.log(i);f.each(function(){$(this).val(N)});G.each(function(){$(this).text(Q)});B.each(function(){$(this).text(L)});g.each(function(){$(this).text(K)});j.each(function(){$(this).attr("src",P)});v(O);C(1);q();H();l.html("-- email --");y.val("");m();n.formwizard("show","checkout-first");w.modal("show")});$("#checkout").on("click",function(M){console.log("Completa acquisto");$(this).prop("disabled",true);var Q=u.val();var S=s.val();var O=0;var N=f.val();var T=D.val();var L=0;var R=o();var P=y.val();if(P==""){alert("Attenzione manca la destinazione E-Mail dove inviare le licenze!");n.formwizard("show","checkout-fourth");y.focus();$("#checkout").prop("disabled",false);return false}console.log(N);var K=$("input:radio[name=checkout-payments]:checked").val();console.log(K);if(K=="paypal"){}else{if(K=="bonifico"){$.post("/ecommerce/license.php",{op_type:"new_ecommerce_purchase",tutorid:Q,customercompany_id:S,usercompany_ref:O,learningproject_id:N,amount:T,costcentre_id:L,price:R,payment:K,email:P}).done(function(U){console.log(U);alert("Grazie. Abbiamo appena inviato le coordinate per eï¬€ettuare il boniï¬?co bancario, controlla che l'email non sia stata bloccata dal tuo sistema antivirus o sia nella cartella spam.");$("#checkout").prop("disabled",false);w.modal("hide")})}else{alert("Attenzione! Nessun metodo di pagamento riconosciuto selezionare il metodo di pagamento.");$("#checkout").prop("disabled",false);n.formwizard("show","checkout-third")}}});var c=function(K){$.get(K,function(L){$("#catalogContent").html(L);$("[rel=popover]").popover({html:true,trigger:"hover",placement:"top",container:".store-item-info",content:function(){return $(this).parent("div").children(".mycontent").html()}})})};var F=function(K){total=0;$.get(K,function(O){var N=JSON.parse(O);for(var M=0;M<N.length;M++){var L=N[M];total+=parseInt(L.counter);$(".btnCourse[ref="+L.subcategory_id+"]").children("span").html(L.counter)}console.log(K);$("#tuttiSicurezzaCounter").html(total)})};$(".btnCourse").on("click",function(){$("#tuttiLink").removeClass("active");c($(this).attr("href"));return false});F("/ec-course-list.php?id=A&counter=0");c("/ec-course-list.php");$("a.btnCourse").click(function(){$("#tutti-sicurezza").removeClass("active");$("#tutti-ecm").removeClass("active");$("#tutti-varie").removeClass("active")});$(".cat-tab").click(function(){$(".all").addClass("active")});$("#sicurezza-tab").click(function(){c("/ec-course-list.php?id=A");var K=0;$.get("/ec-course-list.php?id=A&counter=0",function(O){var N=JSON.parse(O);for(var M=0;M<N.length;M++){var L=N[M];K+=parseInt(L.counter);$(".btnCourse[ref="+L.subcategory_id+"]").children("span").html(L.counter)}$("#tuttiSicurezzaCounter").html(K);console.log(K)})});$("#ecm-tab").click(function(){c("/ec-course-list.php?id=B");var K=0;$.get("/ec-course-list.php?id=B&counter=0",function(O){var N=JSON.parse(O);for(var M=0;M<N.length;M++){var L=N[M];K+=parseInt(L.counter);$(".btnCourse[ref="+L.subcategory_id+"]").children("span").html(L.counter)}$("#tuttiEcmCounter").html(K);console.log(K)})});$("#varie-tab").click(function(){c("/ec-course-list.php?id=C");var K=0;$.get("/ec-course-list.php?id=C&counter=0",function(O){var N=JSON.parse(O);for(var M=0;M<N.length;M++){var L=N[M];K+=parseInt(L.counter);$(".btnCourse[ref="+L.subcategory_id+"]").children("span").html(L.counter)}$("#tuttiVarieCounter").html(K);console.log(K)})})});